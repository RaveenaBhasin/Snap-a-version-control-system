main code
A major change